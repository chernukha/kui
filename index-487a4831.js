import{g as X,m as G,a as W,r as m,C as K,c as V,j as e,P as _,h as g,T as N,F,B as h,L as y,D as w,E as T,i as C,A as Y,k as S,l as q,n as Q}from"./index-3b24c961.js";import{T as b}from"./index-2742d532.js";import{T as k,D as Z}from"./Table-6d5d8795.js";import{P as $,C as E}from"./index-d761c254.js";const ee=t=>{const{componentCls:r,sizePaddingEdgeHorizontal:n,colorSplit:i,lineWidth:a}=t;return{[r]:Object.assign(Object.assign({},W(t)),{borderBlockStart:`${a}px solid ${i}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",margin:`0 ${t.dividerVerticalGutterMargin}px`,verticalAlign:"middle",borderTop:0,borderInlineStart:`${a}px solid ${i}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${t.dividerHorizontalGutterMargin}px 0`},[`&-horizontal${r}-with-text`]:{display:"flex",alignItems:"center",margin:`${t.dividerHorizontalWithTextGutterMargin}px 0`,color:t.colorTextHeading,fontWeight:500,fontSize:t.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${i}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${a}px solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${r}-with-text-left`]:{"&::before":{width:"5%"},"&::after":{width:"95%"}},[`&-horizontal${r}-with-text-right`]:{"&::before":{width:"95%"},"&::after":{width:"5%"}},[`${r}-inner-text`]:{display:"inline-block",padding:"0 1em"},"&-dashed":{background:"none",borderColor:i,borderStyle:"dashed",borderWidth:`${a}px 0 0`},[`&-horizontal${r}-with-text${r}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${r}-dashed`]:{borderInlineStart:a,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${r}-with-text`]:{color:t.colorText,fontWeight:"normal",fontSize:t.fontSize},[`&-horizontal${r}-with-text-left${r}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${r}-inner-text`]:{paddingInlineStart:n}},[`&-horizontal${r}-with-text-right${r}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${r}-inner-text`]:{paddingInlineEnd:n}}})}},te=X("Divider",t=>{const r=G(t,{dividerVerticalGutterMargin:t.marginXS,dividerHorizontalWithTextGutterMargin:t.margin,dividerHorizontalGutterMargin:t.marginLG});return[ee(r)]},{sizePaddingEdgeHorizontal:0});var re=globalThis&&globalThis.__rest||function(t,r){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)r.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(n[i[a]]=t[i[a]]);return n};const ie=t=>{const{getPrefixCls:r,direction:n}=m.useContext(K),{prefixCls:i,type:a="horizontal",orientation:o="center",orientationMargin:l,className:s,rootClassName:d,children:u,dashed:p,plain:R}=t,U=re(t,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain"]),c=r("divider",i),[B,M]=te(c),D=o.length>0?`-${o}`:o,j=!!u,A=o==="left"&&l!=null,O=o==="right"&&l!=null,J=V(c,M,`${c}-${a}`,{[`${c}-with-text`]:j,[`${c}-with-text${D}`]:j,[`${c}-dashed`]:!!p,[`${c}-plain`]:!!R,[`${c}-rtl`]:n==="rtl",[`${c}-no-default-orientation-margin-left`]:A,[`${c}-no-default-orientation-margin-right`]:O},s,d),H=Object.assign(Object.assign({},A&&{marginLeft:l}),O&&{marginRight:l});return B(m.createElement("div",Object.assign({className:J},U,{role:"separator"}),u&&a!=="vertical"&&m.createElement("span",{className:`${c}-inner-text`,style:H},u)))},x=ie,f=[{key:"critical",color:"red",text:"Critical"},{key:"major",color:"gold",text:"Major"},{key:"minor",color:"green",text:"Minor"},{key:"warning",color:"green",text:"Warning"}];function L({alerts:t}){const r=m.useMemo(()=>f.find(i=>t[i.key]>0),[]);function n(){const i=[];return f.forEach((a,o)=>{const l=t[a.key];i.push(g("span",{children:[a.text,": ",l&&e("b",{children:l})]},a.key)),o<f.length-1&&i.push(e(x,{type:"vertical"},`divider-${o}`))}),i}return e("div",{className:"alerts-status",children:r?e(_,{trigger:"hover",title:"Alerts",overlayClassName:"alerts-status-tooltip",content:n(),children:e(b,{color:r.color,children:r.text})}):e(b,{color:"green",children:"No alerts"})})}const v={broken:{color:"red",text:"Broken"},critical:{color:"gold",text:"Critical"},normal:{color:"green",text:"Normal"}};function z({sloItems:t}){const r=m.useMemo(()=>{let i=0,a=0,o=0;t.forEach(s=>{s.status==="broken"?i++:s.status==="critical"?a++:o++});let l=v.normal;return i?l=v.broken:a&&(l=v.critical),{brokenCount:i,criticalCount:a,normalCount:o,color:l.color,text:l.text}},[]);function n(){const i=a=>a&&e("b",{children:a});return g(F,{children:[g("span",{children:["Broken: ",i(r.brokenCount)]}),e(x,{type:"vertical"}),g("span",{children:["Critical: ",i(r.criticalCount)]}),e(x,{type:"vertical"}),g("span",{children:["Normal: ",i(r.normalCount)]})]})}return e("div",{className:"slo-status",children:t.length>0?e(_,{trigger:"hover",title:"SLO Items Status",overlayClassName:"slo-status-tooltip",content:n(),children:e(b,{color:r.color,children:r.text})}):e(N.Text,{type:"secondary",children:"-"})})}function P({balance:t,limit:r}){let n="green";return t>=r?n="red":t>=r/2&&(n="gold"),e("div",{className:"budget-status",children:g(b,{color:n,children:["$",t," / $",r]})})}function ne({items:t}){return e(k,{className:"slo-table",dataSource:t,columns:[{title:"SLO",key:"name",render:n=>e(y,{to:"/apps",children:n.name})},{title:"Type",key:"type",dataIndex:"type"},{title:"Value",key:"value",render:n=>`${n.value}%`},{title:"Error budget current",key:"error",render:()=>e(N.Text,{type:"secondary",children:"-"})},{title:"Metric",key:"metric",dataIndex:"metric"},{title:" ",key:"actions",width:50,render:n=>e(w,{menu:{items:[{key:"edit",label:"Edit",icon:e(C,{})}]},placement:"bottomRight",trigger:["click"],children:e(h,{icon:e(T,{})})})}],size:"small",rowKey:"id",pagination:!1,locale:{emptyText:"No data"},footer:()=>e(h,{size:"small",icon:e($,{}),children:"Add SLO"})})}function ae({items:t}){return e(k,{className:"user-journey-table",columns:[{title:"User journey",key:"name",width:200,render:n=>e(y,{to:"/apps",children:n.name})},{title:"Alerts",key:"alerts",width:150,render:n=>e(L,{alerts:n.alert})},{title:"Budget",key:"budget",width:150,render:n=>{const[i,a]=n.budget;return e(P,{balance:i,limit:a})}},{title:"SLO",key:"slo",render:n=>e(z,{sloItems:n.sloItems})},{title:" ",key:"actions",width:50,render:n=>e(w,{menu:{items:[{key:"edit",label:"Edit",icon:e(C,{})}]},placement:"bottomRight",trigger:["click"],children:e(h,{icon:e(T,{})})})}],dataSource:t,rowKey:"id",pagination:!1,size:"small",showHeader:!1,expandable:{rowExpandable:()=>!0,expandedRowRender:n=>e(ne,{items:n.sloItems})},footer:()=>e(h,{size:"small",icon:e($,{}),children:"Add User Journey"})})}function oe({apps:t,onAppDelete:r}){const{modal:n}=Y.useApp(),i=[{title:"Name",key:"name",width:200,render:o=>e(y,{to:S.appEdit(o.id),children:o.name})},{title:"Error status",key:"error-status",width:150,render:o=>{let l=0,s=0,d=0,u=0;return o.userJourneyItems.forEach(p=>{l+=p.alert.critical,s+=p.alert.major,d+=p.alert.minor,u+=p.alert.warning}),e(L,{alerts:{critical:l,major:s,minor:d,warning:u}})}},{title:"Budget",key:"budget",width:150,render:o=>{let l=0,s=0;return o.userJourneyItems.forEach(d=>{l+=d.budget[0],s+=d.budget[1]}),e(P,{balance:l,limit:s})}},{title:"SLO",key:"slo",render:o=>{const l=[];return o.userJourneyItems.forEach(s=>l.push(...s.sloItems)),e(z,{sloItems:l})}},{title:" ",key:"actions",width:50,render:o=>{const l=[{key:"edit",label:e(y,{to:S.appEdit(o.id),children:"Edit"}),icon:e(C,{})},{key:"delete",label:"Delete",icon:e(Z,{}),onClick:()=>a(o)}];return e(w,{menu:{items:l},placement:"bottomRight",trigger:["click"],children:e(h,{icon:e(T,{})})})}}];function a(o){n.confirm({content:`Are you sure you want to delete "${o.name}"?`,onOk:()=>r(o)})}return e("div",{className:"apps-table-wrap",children:e(k,{className:"apps-table",dataSource:t,columns:i,rowKey:"id",size:"middle",expandable:{rowExpandable:()=>!0,expandedRowRender:o=>e(ae,{items:o.userJourneyItems})}})})}const le=[{id:"app1",name:"Application 1",userJourneyItems:[{id:"journey1",name:"User journey 1",alert:{critical:1,major:0,minor:0,warning:0},budget:[500,1e3],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:30,metric:"ServiceTestTRXNCount",status:"broken"},{id:"slo2",name:"SLO 2",type:"Availability_time_calendar",value:60,metric:"ServiceTestUpTime",status:"normal"}]},{id:"journey2",name:"User journey 2",alert:{critical:0,major:3,minor:2,warning:0},budget:[300,900],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:89,metric:"ServiceTestTRXNCount",status:"normal"},{id:"slo2",name:"SLO 2",type:"Availability_time_calendar",value:98,metric:"ServiceTestUpTime",status:"normal"}]},{id:"journey3",name:"User journey 3",alert:{critical:2,major:3,minor:0,warning:0},budget:[1e3,2e3],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:99,metric:"ServiceTestTRXNCount",status:"normal"},{id:"slo2",name:"SLO 2",type:"Availability_time_calendar",value:99,metric:"ServiceTestUpTime",status:"normal"}]},{id:"journey4",name:"User journey 4",alert:{critical:0,major:0,minor:0,warning:9},budget:[2e3,3200],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:87,metric:"ServiceTestTRXNCount",status:"broken"}]}]},{id:"app2",name:"Application 2",userJourneyItems:[{id:"journey1",name:"User journey 1",alert:{critical:0,major:0,minor:0,warning:0},budget:[500,1e3],sloItems:[]}]},{id:"app3",name:"Application 3",userJourneyItems:[{id:"journey1",name:"User journey 1",alert:{critical:0,major:3,minor:0,warning:0},budget:[1200,1e3],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:30,metric:"ServiceTestTRXNCount",status:"broken"},{id:"slo2",name:"SLO 2",type:"Availability_time_calendar",value:60,metric:"ServiceTestUpTime",status:"broken"}]}]},{id:"app4",name:"Application 4",userJourneyItems:[{id:"journey1",name:"User journey 1",alert:{critical:0,major:0,minor:2,warning:0},budget:[200,1e3],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:30,metric:"ServiceTestTRXNCount",status:"critical"},{id:"slo2",name:"SLO 2",type:"Availability_time_calendar",value:60,metric:"ServiceTestUpTime",status:"normal"}]},{id:"journey2",name:"User journey 2",alert:{critical:0,major:0,minor:0,warning:4},budget:[100,1e3],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:30,metric:"ServiceTestTRXNCount",status:"normal"},{id:"slo2",name:"SLO 2",type:"Availability_time_calendar",value:60,metric:"ServiceTestUpTime",status:"normal"}]}]},{id:"app5",name:"Application 5",userJourneyItems:[{id:"journey1",name:"User journey 1",alert:{critical:0,major:0,minor:0,warning:2},budget:[200,1e3],sloItems:[{id:"slo1",name:"SLO 1",type:"Availability_time_calendar",value:30,metric:"ServiceTestTRXNCount",status:"normal"}]}]}];function se(){const[t,r]=m.useState(!0);m.useEffect(()=>{setTimeout(()=>r(!1),700)},[]);function n(i){console.log("App delete",i)}return e("div",{className:"apps-page",children:e(E,{title:"Applications",loading:t,type:"inner",extra:e(y,{to:S.appCreate,children:e(h,{type:"primary",icon:e($,{}),children:"Add App"})}),children:e(oe,{apps:le,onAppDelete:n})})})}function I(){const{appId:t}=q();return e("div",{className:"app-edit-page",children:e(E,{title:t?"App edit":"Create app",type:"inner",children:e("i",{children:"In progress"})})})}function pe(){return Q([{path:"",element:e(se,{})},{path:"create",element:e(I,{})},{path:"edit/:appId",element:e(I,{})}])}export{pe as default};
